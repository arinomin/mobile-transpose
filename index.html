<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mobile-transpose</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">

    <!-- Meta Tags for Social Sharing (OGP/Twitter Cards) -->
    <meta property="og:title" content="mobile-transpose">
    <meta property="og:description" content="A simple step sequencer for mobile browsers.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://transpose.replit.app/icon-512.png">
    <meta property="og:url" content="https://transpose.replit.app/">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://transpose.replit.app/icon-512.png">
</head>
<body>
    <div class="container">
        <div class="header-container">
            <h1>mobile-transpose</h1>
            <button class="help-button header-help-button" data-help-topic="general" aria-label="Help">?</button>
        </div>

        <div class="global-controls">
            <div class="control-group">
                <label>Base Note</label>
                <button id="base-note-display-button" class="display-button">C4</button>
            </div>
            <div class="control-group">
                <label>BPM / Rate</label>
                <button id="bpm-rate-display-button" class="display-button">120 / 16分</button>
            </div>
        </div>

        <div id="sequencer-grid" class="sequencer-grid"></div>

        <div class="seq-max-controls">
            <label>SEQ MAX</label>
            <div id="seq-max-buttons" class="seq-max-buttons"></div>
        </div>

    </div>

    <footer class="footer-menu">
        <button id="melody-gen-button" class="footer-button" aria-label="Generate Melody">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12.5,2.5l2.5,5l5,2.5l-5,2.5l-2.5,5l-2.5-5l-5-2.5l5-2.5L12.5,2.5z M5,15l1.5,3l3,1.5l-3,1.5l-1.5,3l-1.5-3l-3-1.5l3-1.5L5,15z"/></svg>
        </button>
        <button id="play-stop-button" class="play-stop-button">
            <div class="play-content">
                <svg class="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                <span>Play</span>
            </div>
            <div class="stop-content">
                <svg class="icon-stop" viewBox="0 0 24 24"><path d="M6 6h12v12H6z"/></svg>
                <span>Stop</span>
            </div>
        </button>
        <button id="share-button" class="footer-button" aria-label="Share">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.18c.52.47 1.2.77 1.96.77c1.66 0 3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65c0 1.66 1.34 3 3 3s3-1.34 3-3s-1.34-3-3-3z"/></svg>
        </button>
    </footer>

    <div id="step-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Step <span id="modal-step-number"></span></h2>
                <button id="close-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="transpose-info">
                    <div id="transpose-value-display" class="info-box"></div>
                    <div id="interval-name-display" class="info-box"></div>
                    <div id="final-note-display" class="info-box"></div>
                </div>
                <div id="transpose-selector" class="transpose-selector">
                    <div class="selector-track"></div>
                    <div class="selector-ticks"></div>
                    <div class="selector-handle"></div>
                </div>
                <div class="transpose-labels">
                    <span>-12</span>
                    <span>0</span>
                    <span>+12</span>
                </div>
                <div class="step-enable-control">
                    <label for="step-enable-toggle">Play Step</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="step-enable-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="audition-button">Audition</button>
                <button id="reset-button">Reset</button>
                <button id="done-step-button">Done</button>
            </div>
        </div>
    </div>

    <div id="bpm-rate-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit BPM & Rate</h2>
                <button id="close-bpm-rate-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="bpm-editor">
                    <h3>BPM</h3>
                    <div class="bpm-adjust-controls">
                        <button id="bpm-down-10">-10</button>
                        <button id="bpm-down-1">-1</button>
                        <span id="modal-bpm-value">120</span>
                        <button id="bpm-up-1">+1</button>
                        <button id="bpm-up-10">+10</button>
                    </div>
                </div>
                <div class="rate-editor">
                    <h3>Rate <button class="help-button" data-help-topic="rate">?</button></h3>
                    <div id="modal-rate-buttons" class="rate-buttons">
                        <button data-rate="4">16分</button>
                        <button data-rate="3">1拍3連</button>
                        <button data-rate="2">8分</button>
                        <button data-rate="1.5">2拍3連</option>
                        <button data-rate="1">4分</button>
                        <button data-rate="0.5">2分</button>
                        <button data-rate="0.25">全音符</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="done-bpm-rate-button">Done</button>
            </div>
        </div>
    </div>

    <div id="base-note-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Base Note</h2>
                <button id="close-base-note-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="note-name-editor">
                    <h3>Note</h3>
                    <div id="modal-note-name-buttons" class="note-name-buttons">
                        <!-- Note name buttons will be generated by JS -->
                    </div>
                </div>
                <div class="octave-editor">
                    <h3>Octave</h3>
                    <div id="modal-octave-buttons" class="octave-buttons">
                        <!-- Octave buttons will be generated by JS -->
                    </div>
                </div>
                <div class="waveform-editor">
                    <h3>Waveform <button class="help-button" data-help-topic="waveform">?</button></h3>
                    <div id="modal-waveform-buttons" class="waveform-buttons">
                        <!-- Waveform buttons will be generated by JS -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="done-base-note-button">Done</button>
            </div>
        </div>
    </div>

    <div id="melody-gen-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Melody Generator</h2>
                <button id="close-melody-gen-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="melody-gen-control">
                    <label for="melody-key-select">Key <button class="help-button" data-help-topic="key">?</button></label>
                    <select id="melody-key-select">
                        <option value="C">C</option>
                        <option value="C#">C#</option>
                        <option value="D">D</option>
                        <option value="D#">D#</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F#</option>
                        <option value="G">G</option>
                        <option value="G#">G#</option>
                        <option value="A">A</option>
                        <option value="A#">A#</option>
                        <option value="B">B</option>
                    </select>
                </div>
                <div class="melody-gen-control">
                    <label for="melody-scale-select">Scale <button class="help-button" data-help-topic="scale">?</button></label>
                    <select id="melody-scale-select">
                        <option value="major">Major</option>
                        <option value="minor">Natural Minor</option>
                        <option value="harmonicMinor">Harmonic Minor</option>
                        <option value="dorian">Dorian</option>
                        <option value="mixolydian">Mixolydian (7th)</option>
                        <option value="majorPentatonic">Major Pentatonic</option>
                        <option value="minorPentatonic">Minor Pentatonic</option>
                        <option value="blues">Blues</option>
                    </select>
                </div>
                <div class="melody-gen-control">
                    <label for="melody-algorithm-select">Algorithm <button class="help-button" data-help-topic="algorithm">?</button></label>
                    <select id="melody-algorithm-select">
                        <option value="simple-walk">Simple Walk</option>
                        <option value="leaps-and-rests">Leaps & Rests</option>
                        <option value="arpeggio-up">Arp Up</option>
                        <option value="arpeggio-down">Arp Down</option>
                        <option value="arpeggio-random">Arp Random</option>
                    </select>
                </div>
                <div class="melody-gen-control">
                    <label for="melody-rest-probability">Rest Probability <button class="help-button" data-help-topic="rest-probability">?</button></label>
                    <div class="slider-container">
                        <input type="range" id="melody-rest-probability" min="0" max="0.8" step="0.1" value="0">
                        <span id="melody-rest-probability-value">0%</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="preview-melody-button">Generate & Preview</button>
                <button id="apply-melody-button" disabled>Apply</button>
            </div>
        </div>
    </div>

    <div id="share-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>共有</h2>
                <button id="close-share-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <p>シーケンサーを共有しましょう。</p>
                <input type="text" id="share-url-input" readonly class="share-url-display">
                <div class="share-buttons-container">
                    <button id="copy-url-button" class="action-button">URLをコピー</button>
                    <button id="share-x-button" class="action-button">Xで共有</button>
                </div>
            </div>
        </div>
    </div>

    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="help-modal-title"></h2>
                <button id="close-help-modal-button" class="close-button">&times;</button>
            </div>
            <div class="modal-body" id="help-modal-content-body">
                <p id="help-modal-content"></p>
            </div>
            <div class="modal-footer">
                <div id="help-language-switcher" class="language-switcher">
                    <button data-lang="en" class="lang-button selected">English</button>
                    <button data-lang="ja" class="lang-button">日本語</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="app-footer">
        <p>Developed by arinomi</p>
        <nav class="footer-links">
            <a href="https://arinomi.replit.app/#contact" target="_blank" rel="noopener noreferrer">Contact</a>
            <a href="https://x.com/arinomi_loop" target="_blank" rel="noopener noreferrer" aria-label="X (formerly Twitter)">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
            </a>
            <a href="https://github.com/arinomin/mobile-transpose" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
            </a>
        </nav>
        <p class="copyright">&copy; 2025 arinomi</p>
    </footer>

    <script type="module" src="js/main.js"></script>
</body>
</html>